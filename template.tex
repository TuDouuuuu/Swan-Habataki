\documentclass{article}
\usepackage{fontspec, xunicode, xltxtra} 
\setmainfont{Microsoft YaHei} 
\usepackage{ctex} 
\usepackage{geometry}
\usepackage[Glenn]{fncychap}
\usepackage{listings}
\usepackage{color}
\usepackage{verbatim}
\usepackage{fancyhdr}

\title{靠别人，你永远是右倾投降主义\\靠自己，你才是工农武装割据}
\author{ZJUT14}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}


\lhead{\CJKfamily{kai} Zhejiang University of Technology}
\chead{}

\geometry{left=2.5cm,right=1.7cm,top=2cm,bottom=1.7cm}
\rhead{\CJKfamily{kai} 第 \thepage 页}
\lfoot{} 
\cfoot{\thepage}
\rfoot{}
\newcommand{\makefirstpageheadrule}{
\makebox[0pt][l]{\rule[0.55\baselineskip]{\headwidth}{0.4pt}}
\rule[0.7\baselineskip]{\headwidth}{0.4pt}}

\renewcommand{\footrulewidth}{0.2pt}
\setlength{\skip\footins}{0.3cm}

\lstset{
    frame=simple,
    language=  c++,
    aboveskip=3mm,
    belowskip=3mm,
    showstringspaces=false,
    basicstyle={\small\ttfamily},
    numbers=none,
    numberstyle=\tiny\color{gray},
    keywordstyle=\fontspec{Consolas Bold}\bfseries,
    commentstyle=\color{dkgreen},
    stringstyle=\color{mauve},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=4,
    numbers = left,
    numberstyle={                               
        \normalsize
        \color{black}
        \fontspec{Consolas}
    },
}

\begin{document}
\begin{titlepage}
\maketitle
\thispagestyle{empty}
\pagebreak
\pagestyle{plain}
\tableofcontents
\end{titlepage}



\section{数学}
\section{数据结构}
\section{poi}
\subsection{树状数组}
\end{document}